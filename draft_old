class BlogView(TemplateView):
    template_name = 'blog.html'
    blog_form = BlogForm

    def get_context_data(self, **kwargs):
        context = super(BlogView, self).get_context_data(**kwargs)
        context.update(csrf(self.request))

        char = get_object_or_404(Character, username=self.kwargs['username'])
        context['blog_list'] = char.blog.all().order_by('pub_date')

        return context


class BlogForm(forms.ModelForm):

    parent = forms.IntegerField(
        widget=forms.HiddenInput,
        required=False
    )

    class Meta:
        model = Blog
        fields = ['text']


class ArticlesView(TemplateView):
    template_name = 'comments.html'
    comment_form = CommentForm

    def get_context_data(self, **kwargs):
        context = super(ArticlesView, self).get_context_data(**kwargs)
        blog = get_object_or_404(Blog, id=self.kwargs['id'])
        context['blog'] = blog
        context['blog_list'] = blog.commentary.all().order_by('pub_date')

        return context